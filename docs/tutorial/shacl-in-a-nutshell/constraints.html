<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="description" content="nexus">
<meta name="generator" content="Paradox, paradox-material-theme=0.5.1, mkdocs-material=3.0.3">

<meta name="lang:clipboard.copy" content="Copy to clipboard">
<meta name="lang:clipboard.copied" content="Copied to clipboard">
<meta name="lang:search.language" content="">
<meta name="lang:search.pipeline.stopwords" content="true">
<meta name="lang:search.pipeline.trimmer" content="true">
<meta name="lang:search.result.none" content="No matching documents">
<meta name="lang:search.result.one" content="1 matching document">
<meta name="lang:search.result.other" content="# matching documents">
<meta name="lang:search.tokenizer" content="[\s\-]+">


<meta name="description" content="nexus">
<link rel="shortcut icon" href="../../.././assets/img/favicon-32x32.png">
<title>Constraints</title>
<link rel="stylesheet" href="../../../assets/stylesheets/application.451f80e5.css">
<link rel="stylesheet" href="../../../assets/stylesheets/application-palette.22915126.css">
<meta name="theme-color" content="#03a9f4" />
<link rel="stylesheet" href="../../../lib/material__tabs/dist/mdc.tabs.min.css">
<link rel="stylesheet" href="../../../lib/prettify/prettify.css">
<script src="../../../assets/javascripts/modernizr.1aa3b519.js"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
<style>
body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}
code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}
</style>
<link rel="stylesheet" href="../../../assets/fonts/font-awesome.css">
<link rel="stylesheet" href="../../../assets/fonts/material-icons.css">
<link rel="stylesheet" href="../../../assets/stylesheets/paradox-material-theme.css">
<link rel="stylesheet" href="../../.././assets/css/docs.css">
</head>
<body
data-md-color-primary="light-blue"
data-md-color-accent="cyan"
>
<input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
<input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
<label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
<header class="md-header" data-md-component="header">
<nav class="md-header-nav md-grid">
<div class="md-flex">
<div class="md-flex__cell md-flex__cell--shrink">
<a href="../../../docs/tutorial/shacl-in-a-nutshell/constraints.html" title="Constraints" class="md-header-nav__button md-logo">
<img src="../../.././assets/img/logo.png" width="24" height="24">
</a>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
</div>
<div class="md-flex__cell md-flex__cell--stretch">
<div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
Constraints
</div>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
<label class="md-icon md-search__icon" for="__search"></label>
<button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">&#xE5CD;</button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix>
<div class="md-search-result" data-md-component="result">
<div class="md-search-result__meta">
Type to start searching
</div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>

</div>
<div class="md-flex__cell md-flex__cell--shrink">
<div class="md-header-nav__source">
<a href="https://github.com/BlueBrain/nexus"
title="Go to repository"
class="md-source"
data-md-source="github">
<div class="md-source__icon">
<i class="fa fa-github"></i>
</div>
<div class="md-source__repository">
BlueBrain/nexus
</div>
</a>

</div>
</div>
</div>
</nav>
</header>

<div class="md-container">
<main class="md-main">
<div class="md-main__inner md-grid" data-md-component="container">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--primary" data-md-level="0" style="visibility: hidden">
<label class="md-nav__title md-nav__title--site" for="drawer">
<a href="../../../docs/tutorial/shacl-in-a-nutshell/constraints.html" title="Constraints" class="md-nav__button md-logo">
<span class="md-nav__button md-logo">
<img src="../../.././assets/img/logo.png" width="24" height="24">
</a>
<a href="../../../docs/tutorial/shacl-in-a-nutshell/constraints.html" title="Constraints">
Constraints
</a>
</label>
<div class="md-nav__source">
<a href="https://github.com/BlueBrain/nexus"
title="Go to repository"
class="md-source"
data-md-source="github">
<div class="md-source__icon">
<i class="fa fa-github"></i>
</div>
<div class="md-source__repository">
BlueBrain/nexus
</div>
</a>

</div>
<ul>
</ul>
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul>
  <li><a href="../../../docs/tutorial/shacl-in-a-nutshell/constraints.html#constraints" class="header">Constraints</a>
  <ul>
    <li><a href="../../../docs/tutorial/shacl-in-a-nutshell/constraints.html#nodekind-constraint" class="header">NodeKind Constraint</a></li>
    <li><a href="../../../docs/tutorial/shacl-in-a-nutshell/constraints.html#property-constraints" class="header">Property Constraints</a></li>
    <li><a href="../../../docs/tutorial/shacl-in-a-nutshell/constraints.html#qualified-cardinality" class="header">Qualified Cardinality</a></li>
    <li><a href="../../../docs/tutorial/shacl-in-a-nutshell/constraints.html#combining-shapes" class="header">Combining shapes</a></li>
    <li><a href="../../../docs/tutorial/shacl-in-a-nutshell/constraints.html#logical-combination-of-shapes" class="header">Logical combination of shapes</a></li>
    <li><a href="../../../docs/tutorial/shacl-in-a-nutshell/constraints.html#shape-specialization" class="header">Shape specialization</a></li>
    <li><a href="../../../docs/tutorial/shacl-in-a-nutshell/constraints.html#frequent-shacl-validation-errors" class="header">Frequent SHACL validation errors</a></li>
  </ul></li>
</ul>
</nav>

</nav>
<ul style="display: none">
<li class="md-nav__item md-version" id="project.version">
<label class="md-nav__link" for="__version">
<i class="md-icon" title="Version">label_outline</i> 0.1.0*
</label>
</li>
</ul>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul>
  <li><a href="../../../docs/tutorial/shacl-in-a-nutshell/constraints.html#constraints" class="header">Constraints</a>
  <ul>
    <li><a href="../../../docs/tutorial/shacl-in-a-nutshell/constraints.html#nodekind-constraint" class="header">NodeKind Constraint</a></li>
    <li><a href="../../../docs/tutorial/shacl-in-a-nutshell/constraints.html#property-constraints" class="header">Property Constraints</a></li>
    <li><a href="../../../docs/tutorial/shacl-in-a-nutshell/constraints.html#qualified-cardinality" class="header">Qualified Cardinality</a></li>
    <li><a href="../../../docs/tutorial/shacl-in-a-nutshell/constraints.html#combining-shapes" class="header">Combining shapes</a></li>
    <li><a href="../../../docs/tutorial/shacl-in-a-nutshell/constraints.html#logical-combination-of-shapes" class="header">Logical combination of shapes</a></li>
    <li><a href="../../../docs/tutorial/shacl-in-a-nutshell/constraints.html#shape-specialization" class="header">Shape specialization</a></li>
    <li><a href="../../../docs/tutorial/shacl-in-a-nutshell/constraints.html#frequent-shacl-validation-errors" class="header">Frequent SHACL validation errors</a></li>
  </ul></li>
</ul>
</nav>

</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<div class="md-content__searchable">
<h1><a href="#constraints" name="constraints" class="anchor"><span class="anchor-link"></span></a>Constraints</h1>
<p>Co-occurrence constraints</p>
<p>A shape can defined a set of constraints to be checked against selected nodes. The set of possible constraints can be divided into two categories:</p>
<ul>
  <li>NodeKind constraint: about selected nodes themselves</li>
  <li>Property constraints: about outgoing or incoming properties of each selected node</li>
</ul>
<h4><a href="#nodekind-constraint" name="nodekind-constraint" class="anchor"><span class="anchor-link"></span></a>NodeKind Constraint</h4>
<p>The nodeKind constraint allows to choose if a selected need to be identified by an IRI eventually consistent with a specific pattern or if it can unidentified. <strong>At most one nodeKind</strong> constraint can be defined for a given NodeShape.</p>
<p>The following schema states that all values of the property <strong>bbp:morphology</strong> have to be nodes identified by IRIs.</p>
<pre class="prettyprint"><code class="language-json--schemas">{
  &quot;@id&quot; : &quot;{endpoint}/schemas/bbp/simulation/circuit/v1.0.0/&quot;,
  &quot;shapes&quot; : [ {
    &quot;@id&quot; : &quot;{endpoint}/schemas/bbp/simulation/circuit/v1.0.0/shapes/MorphologyPropertyObject&quot;,
    &quot;@type&quot; : &quot;sh:NodeShape&quot;,
    &quot;targetObjectsOf&quot; : &quot;bbp:morphology&quot;,
    &quot;nodeKind&quot;: &quot;sh:IRI&quot;
  } ]
}
</code></pre>
<p><img src="../../../images/circuit_nodekind_iri.svg" alt="Instance target" /></p>
<p>In the previous example, the node <strong>&ldquo;Morphology_1&rdquo;</strong> (red border) is an object of the property <strong>bbp:morphology</strong> which is a Literal (precisely a string literal). So it&rsquo;s not identifier by an IRI which makes it invalid. The node <strong>bbp:Morphology_2</strong> (green border) on the other hand is valid because it is an object property of the property <strong>bbp:morphology</strong> and is identified by an IRI. All values of the <strong>nodeKind</strong> constraint are listed in the table below:</p>
<table>
  <thead>
    <tr>
      <th>Value </th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>sh:IRI </td>
      <td>The selected nodes have to be identified by a valid <a href="http://www.ietf.org/rfc/rfc3987.txt">IRI</a>.</td>
    </tr>
    <tr>
      <td>sh:BlankNode </td>
      <td>The selected nodes should not be identified by an IRI nor be a Literal.</td>
    </tr>
    <tr>
      <td>sh:Literal </td>
      <td>The selected nodes should be a Literal.</td>
    </tr>
    <tr>
      <td>sh:BlankNodeOrIRI </td>
      <td>Disjunctive combination of sh:BlankNode and sh:IRI.</td>
    </tr>
    <tr>
      <td>sh:BlankNodeOrLiteral </td>
      <td>Disjunctive combination of sh:BlankNode and sh:Literal.</td>
    </tr>
    <tr>
      <td>sh:IRIOrLiteral </td>
      <td>Disjunctive combination of sh:IRI and sh:Literal.</td>
    </tr>
  </tbody>
</table>
<h4><a href="#property-constraints" name="property-constraints" class="anchor"><span class="anchor-link"></span></a>Property Constraints</h4>
<blockquote>
  <p>Definition of <strong>bbp:morphology</strong> as an outgoing property of any instance of <strong>bbp:Circuit</strong>:</p>
</blockquote>
<pre class="prettyprint"><code class="language-json--schemas">{
  &quot;@id&quot; : &quot;{endpoint}/schemas/bbp/simulation/circuit/v1.0.0/&quot;,
  &quot;shapes&quot; : [ {
    &quot;@id&quot; : &quot;{endpoint}/schemas/bbp/simulation/circuit/v1.0.0/shapes/Circuit&quot;,
    &quot;@type&quot; : &quot;sh:NodeShape&quot;,
    &quot;targetClass&quot; : &quot;bbp:Circuit&quot;,
    &quot;nodeKind&quot;: &quot;sh:IRI&quot;,
    &quot;property&quot; : [ {
          &quot;path&quot; : &quot;bbp:morphology&quot;,
          &quot;name&quot; : &quot;morphologies&quot;,
          &quot;description&quot; : &quot;Collection of morphologies used in the circuit building.&quot;
        }
    } ]
  ]
}
</code></pre>
<p>Given a selected node, a shape defines a set of outgoing and/or incoming properties as well as a set of constraints for each of them. By doing so, a shape enforce a vocabulary (a set of properties) to be used for describing the selected nodes (instances of bbp:Circuit in the schema for example) and how that vocabulary should be used (constraints).</p>
<p>To define a set of incoming and/or outgoing properties, the <strong>property key</strong> is used. It is an array and each of its item is an instance of a <strong>PropertyShape</strong>. The following tables describe the minimal keys to use in order to define a property:</p>
<table>
  <thead>
    <tr>
      <th>key </th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>path </td>
      <td>MAandatory. Refers to the property IRI (&ldquo;bbp:morphology&rdquo; in the schema example) in case of outgoing property. For an incoming one, the following syntax is used: <strong>&ldquo;path&rdquo; : [ &ldquo;sh:inversePath prov:generated&rdquo; ]</strong>.</td>
    </tr>
    <tr>
      <td>name </td>
      <td>Optional. A human readable name of the property. The name can be used in generated forms for example.</td>
    </tr>
    <tr>
      <td>description </td>
      <td>Optional. Description of the property.</td>
    </tr>
  </tbody>
</table>
<p>Once the property shape is defined, a set of constraints can be attached to it.</p>
<ul>
  <li>Cardinality Constraints</li>
</ul>
<pre class="prettyprint"><code class="language-json--schemas">{
  &quot;@id&quot; : &quot;{endpoint}/schemas/bbp/simulation/circuit/v1.0.0/&quot;,
  &quot;shapes&quot; : [ {
    &quot;@id&quot; : &quot;{endpoint}/schemas/bbp/simulation/circuit/v1.0.0/shapes/Circuit&quot;,
    &quot;@type&quot; : &quot;sh:NodeShape&quot;,
    &quot;targetClass&quot; : &quot;bbp:Circuit&quot;,
    &quot;nodeKind&quot;: &quot;sh:IRI&quot;,
    &quot;property&quot; : [ {
          &quot;path&quot; : &quot;bbp:morphology&quot;,
          &quot;name&quot; : &quot;morphologies&quot;,
          &quot;description&quot; : &quot;Collection of morphologies used in the circuit building.&quot;,
          &quot;minCount&quot;:&quot;1&quot;,
          &quot;maxCount&quot;:&quot;3&quot;
        },
        {
          &quot;path&quot; : &quot;bbp:dataSpace&quot;,
          &quot;name&quot; : &quot;Data Space&quot;,
          &quot;description&quot; : &quot;Data Space.&quot;,
          &quot;minCount&quot;:&quot;1&quot;
        }
    ]
  }
  ]
}
</code></pre>
<p>How many outgoing &ldquo;bbp:morphology&rdquo; properties a specific bbp:Circuit instance can have ? A question that can be reformulated as: how many triples following the pattern <strong>(bbp:Circuit_*, bbp:morphology, object)</strong> can exist in the data graph ? The answers can be: <strong>zero or more</strong>, <strong>exactly one</strong>, <strong>at most one</strong>. To enforce one of these answers a cardinality constraint can be defined and attached to a property shape as shown in the schema example. The default value for minCount and maxCount is 0.</p>
<p>The example schema states that all instances of bbp:Circuit should have at least one value for <strong>bbp:morphology</strong> property and at most 3 values. They should have at least one value for <strong>bbp:dataSpace</strong> property as well. In the example data graph below, <strong>bbp:Circuit_1</strong> is valid because it has one value for bbp:morphology property and one value for bbp:dataSpace. On the other hand, <strong>bbp:Circuit_2</strong> is not valid because it has not a value for bbp:dataSpace property.</p>
<p><img src="../../../images/circuit_1valid_1invalid.svg" alt="Instance target" /></p>
<ul>
  <li>Property Value Type Constraints</li>
</ul>
<pre class="prettyprint"><code class="language-json--schemas">{
  &quot;@id&quot; : &quot;{endpoint}/schemas/bbp/simulation/circuit/v1.0.0/&quot;,
  &quot;shapes&quot; : [ {
    &quot;@id&quot; : &quot;{endpoint}/schemas/bbp/simulation/circuit/v1.0.0/shapes/Circuit&quot;,
    &quot;@type&quot; : &quot;sh:NodeShape&quot;,
    &quot;targetClass&quot; : &quot;bbp:Circuit&quot;,
    &quot;nodeKind&quot;: &quot;sh:IRI&quot;,
    &quot;property&quot; : [ {
          &quot;path&quot; : &quot;bbp:morphology&quot;,
          &quot;name&quot; : &quot;morphologies&quot;,
          &quot;description&quot; : &quot;Collection of morphologies used in the circuit building.&quot;,
          &quot;class&quot;: &quot;bbp:Morphology&quot;,
          &quot;minCount&quot;:&quot;1&quot;,
          &quot;maxCount&quot;:&quot;3&quot;
        },
        {
          &quot;path&quot; : &quot;bbp:dataSpace&quot;,
          &quot;name&quot; : &quot;Data Space&quot;,
          &quot;description&quot; : &quot;Data Space.&quot;,
          &quot;minCount&quot;:&quot;1&quot;
        },
        {
          &quot;path&quot; : &quot;bbp:brainRegion&quot;,
          &quot;name&quot; : &quot;Brain region&quot;,
          &quot;description&quot; : &quot;Brain region.&quot;,
          &quot;minCount&quot;:&quot;1&quot;,
          &quot;maxCount&quot;:&quot;3&quot;,
          &quot;node&quot;: &quot;circuitshape:LabeledOntologyTermShape&quot;
        },
        {
          &quot;path&quot; : &quot;schema:name&quot;,
          &quot;name&quot; : &quot;Name&quot;,
          &quot;description&quot; : &quot;Circuit name&quot;,
          &quot;datatype&quot;: &quot;xsd:string&quot;,
          &quot;minCount&quot;:&quot;1&quot;,
          &quot;maxCount&quot;:&quot;1&quot;
        }
    ]
  },
  {
        &quot;@id&quot; : &quot;circuitshape:LabeledOntologyTermShape&quot;,
        &quot;@type&quot; : &quot;sh:NodeShape&quot;,
        &quot;nodeKind&quot;: &quot;sh:IRI&quot;,
        &quot;property&quot; : [ {
          &quot;path&quot; : &quot;rdfs:label&quot;,
          &quot;name&quot; : &quot;label&quot;,
          &quot;description&quot; : &quot;Human readable label&quot;,
          &quot;datatype&quot;: &quot;xsd:string&quot;,
          &quot;maxCount&quot; : 1,
          &quot;minCount&quot; : 1

        }
   }
  ]
}
</code></pre>
<p>The type of a property value can be restricted. In the schema example, all instances of <strong>bbp:circuit</strong> should have exactly one name which should be of type <strong>string</strong>. How to express such type restriction in a shacl schema ?</p>
<p><strong>Primitive type as property value</strong></p>
<p>A property value can be of a primitive type: string, integer, double, anyURI, &hellip; and <strong>datatype</strong> key is used to define such primitive expected types as shown in the  shacl schema example. The namespace of all primitive types is <strong>xsd</strong> and for a complete list of those types please check <a href="https://www.w3.org/TR/2001/REC-xmlschema-2-20010502/#built-in-primitive-datatypes">here</a>.</p>
<p>Property values are not always primitive and two other typical situations may occurs.</p>
<p><strong>Reference as property value</strong></p>
<p>The type of a property value can be restricted to be an instance of a specific class. For example, it may be useful to enforce all values of the bbp:morphology property of a given circuit to be of type bbp:Morphology. To express this type of constraint the key <strong>class</strong> is used as shown in the schema example. The ability to constraint types is important to ensure the quality and reliability of the data being submitted into the Nexus platform and SHACL allows to do that without writing a single line of validation code.</p>
<p><strong>Node as property value</strong></p>
<p>Sometimes it may be useful to enforce that a property value has a particular shape instead of being of a specific type. For example, we may want to enforce all brain region values of a all circuits (instances of bbp:Circuit) to have at least an IRI as identifier (&ldquo;nodeKind&rdquo;: &ldquo;sh:IRI&rdquo;) and a label as human readable description. The key <strong>node</strong> is used to express a shape constraint.</p>
<h4><a href="#qualified-cardinality" name="qualified-cardinality" class="anchor"><span class="anchor-link"></span></a>Qualified Cardinality</h4>
<pre class="prettyprint"><code class="language-json--schemas">{
  &quot;@id&quot; : &quot;{endpoint}/schemas/bbp/simulation/circuit/v1.0.0/&quot;,
  &quot;shapes&quot; : [ {
    &quot;@id&quot; : &quot;{endpoint}/schemas/bbp/simulation/circuit/v1.0.0/shapes/Circuit&quot;,
    &quot;@type&quot; : &quot;sh:NodeShape&quot;,
    &quot;targetClass&quot; : &quot;bbp:Circuit&quot;,
    &quot;nodeKind&quot;: &quot;sh:IRI&quot;,
    &quot;property&quot; : [ {
      &quot;path&quot; : &quot;bbp:morphology&quot;,
      &quot;name&quot; : &quot;morphologies&quot;,
      &quot;description&quot; : &quot;Collection of morphologies used in the circuit building.&quot;,
      &quot;class&quot;: &quot;bbp:Morphology&quot;,
      &quot;minCount&quot;:&quot;3&quot;,
      &quot;maxCount&quot;:&quot;3&quot;
    },
    {
      &quot;path&quot; : &quot;bbp:morphology&quot;,
      &quot;qualifiedValueShape&quot;: {
         &quot;class&quot; : &quot;bbp:RawMorphology&quot;
      },
      &quot;qualifiedValueShapesDisjoint&quot;: true,
      &quot;qualifiedMinCount&quot;:1,
      &quot;qualifiedMaxCount&quot;:1
    },
    {
      &quot;path&quot; : &quot;bbp:morphology&quot;,
      &quot;qualifiedValueShape&quot;: {
         &quot;class&quot; : &quot;bbp:SynthesizedMorphology&quot;
      },
      &quot;qualifiedValueShapesDisjoint&quot;: true,
      &quot;qualifiedMinCount&quot;:1
    }
    ]
  }
  ]
}
</code></pre>
<p>Cardinality constraints can be more complex than what is presented in the <a href="/documentation/shacl-schemas.html#cardinality-constraints">constraints section above</a>. A complex cardinality use case can be expressed in the following way : *a bbp:Circuit instance should be linked with exactly 3 Morphologies (instances of bbp:Morphology) *exactly one of them should be a raw morphology (an instance of bbp:RawMorphology) *at least one of them should be synthesized morphology (an instance of bbp:SynthesizedMorphology) *and a bbp:Circuit instance can&rsquo;t be at the same time of type bbp:RawMorphology and bbp:SynthesizedMorphology</p>
<p>The schema example shows how to implement the above constraints using the following keys:</p>
<table>
  <thead>
    <tr>
      <th>key </th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>qualifiedValueShape</strong> </td>
      <td>Mandatory. The shape that the specified (through qualifiedMinCount and qualifiedMaxCount) number of nodes should be consistent with.</td>
    </tr>
    <tr>
      <td><strong>qualifiedMinCount</strong> </td>
      <td>Mandatory. The minimum number of nodes that should be consistent with the shape in qualifiedValueShape</td>
    </tr>
    <tr>
      <td><strong>qualifiedMaxCount</strong> </td>
      <td>Mandatory. The maximum number of nodes that should be consistent with the shape in qualifiedValueShape</td>
    </tr>
    <tr>
      <td><strong>qualifiedValueShapesDisjoint</strong> </td>
      <td>Optional. If true then the values conform to the current property shape must not conform to the siblings property shapes</td>
    </tr>
  </tbody>
</table>
<h4><a href="#combining-shapes" name="combining-shapes" class="anchor"><span class="anchor-link"></span></a>Combining shapes</h4>
<p>Until now we&rsquo;ve described how to define a shape that targets different nodes using different <a href="/documentation/shacl-schemas.html#target-declaration">selectors</a> and enforcing different type of <a href="/documentation/shacl-schemas.html#constraints">constraints</a>. But designing real life schemas is complex and often required reuse of already defined ones. Two use cases can occur when it comes to reuse SHACL schemas:</p>
<ul>
  <li><strong>reuse a shape by combining it with other shapes using boolean operators</strong></li>
  <li><strong>specialization mechanism between shapes</strong></li>
</ul>
<h4><a href="#logical-combination-of-shapes" name="logical-combination-of-shapes" class="anchor"><span class="anchor-link"></span></a>Logical combination of shapes</h4>
<blockquote>
  <p>A node shape definition for all instances of <strong>bbp:Entity</strong></p>
</blockquote>
<pre class="prettyprint"><code class="language-json--schemas">{
  &quot;@id&quot; : &quot;{endpoint}/schemas/bbp/core/entity/v1.0.0/&quot;,
  &quot;shapes&quot; : [ {
    &quot;@id&quot; : &quot;this:EntityShape&quot;,
    &quot;@type&quot; : &quot;sh:NodeShape&quot;,
    &quot;targetClass&quot; : &quot;bbp:Entity&quot;,
    &quot;nodeKind&quot;: &quot;sh:IRI&quot;,
    &quot;property&quot; : [{
      &quot;path&quot; : &quot;schema:name&quot;,
      &quot;name&quot; : &quot;Name&quot;,
      &quot;description&quot; : &quot;Entity name&quot;,
      &quot;or&quot;:[
          {
            &quot;datatype&quot;: &quot;xsd:string&quot;
          },
          {
            &quot;datatype&quot;: &quot;xsd:integer&quot;
          }
      ]
    },{
      &quot;path&quot; : &quot;schema:description&quot;,
      &quot;name&quot; : &quot;Description&quot;,
      &quot;description&quot; : &quot;The entity description&quot;,
      &quot;datatype&quot; : &quot;xsd:string&quot;
    }
    ]
  }
  ]
}
</code></pre>
<pre class="prettyprint"><code class="language-json--schemas">{
  &quot;@id&quot; : &quot;{endpoint}/schemas/bbp/simulation/circuit/v1.0.0/&quot;,
  &quot;@type&quot;: &quot;owl:Ontology&quot;,
  &quot;imports&quot; : [ &quot;{endpoint}/schemas/bbp/core/entity/v1.0.0/&quot;],
  &quot;shapes&quot; : [ {
    &quot;@id&quot; : &quot;this:Circuit&quot;,
    &quot;@type&quot; : &quot;sh:NodeShape&quot;,
    &quot;targetClass&quot; : &quot;bbp:Circuit&quot;,
    &quot;nodeKind&quot;: &quot;sh:IRI&quot;,
     &quot;and&quot;:[{
        &quot;node&quot;:&quot;{endpoint}/schemas/bbp/core/entity/v1.0.0/shapes/EntityShape&quot;
      },
      {
       &quot;property&quot; : [ {
                &quot;path&quot; : &quot;bbp:morphology&quot;,
                &quot;name&quot; : &quot;morphologies&quot;,
                &quot;description&quot; : &quot;Collection of morphologies used in the circuit building.&quot;,
                &quot;class&quot;: &quot;bbp:Morphology&quot;,
                &quot;minCount&quot;:&quot;1&quot;,
                &quot;maxCount&quot;:&quot;3&quot;
              }
          ]
      }
    ]
  }
  ]
}
</code></pre>
<p>Shapes can be combined using the following boolean operators:</p>
<table>
  <thead>
    <tr>
      <th>key </th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>and</strong> </td>
      <td>The data has to be valid with respect to all combined shapes</td>
    </tr>
    <tr>
      <td><strong>or</strong> </td>
      <td>The data has to be valid with respect to at least one shape</td>
    </tr>
    <tr>
      <td><strong>xone</strong> </td>
      <td>The data has to be valid with respect to only one shape</td>
    </tr>
    <tr>
      <td><strong>not</strong> </td>
      <td>The data should not be valid with respect to the given shape(s)</td>
    </tr>
  </tbody>
</table>
<p>In the previous schema (identified by <strong>{endpoint}/schemas/bbp/simulation/circuit/v1.0.0/</strong>), the property shape related to <strong>schema:name</strong> property can be externalized in a schema ({endpoint}/schemas/bbp/core/entity/v1.0.0/) belonging to the &ldquo;bbp&rdquo; organization, &ldquo;core&rdquo; domain and named &ldquo;entity&rdquo; as shown in the right tab. Now let reuse (see in the right) the entity schema since a <strong>bbp:Circuit</strong> is a <strong>bbp:Entity</strong> as well. Basically, the schema is expressing that a bbp:Circuit instance <strong>should be consistent with respect to the schema for bbp:Entity (external one) and the one for bbp:Circuit (local one)</strong>.</p>
<aside class="notice">
Note the use of the **imports** key. It tells the shacl validator where to find the shapes that are referenced in the local schema:
"node":"{endpoint}/schemas/bbp/core/entity/v1.0.0/shapes/EntityShape" for example. Only published schemas can be imported.
</aside>
<p>The <strong>or</strong>, <strong>xone</strong> and <strong>not</strong> operators can be used in the same way as the <strong>and</strong> one. The example shows how to logically combined two node shapes. Property shapes can be combined as well as shown in the shape <strong>this:EntityShape</strong> where the property <strong>schema:name</strong> van be of type string of integer.</p>
<aside class="notice">
All shapes that are listed in the shapes array are by default considered combined in conjunctive way (and operator).
</aside>
<h4><a href="#shape-specialization" name="shape-specialization" class="anchor"><span class="anchor-link"></span></a>Shape specialization</h4>
<pre class="prettyprint"><code class="language-json--schemas">{
  &quot;@id&quot; : &quot;{endpoint}/schemas/bbp/simulation/circuit/v1.0.0/&quot;,
  &quot;@type&quot;: &quot;owl:Ontology&quot;,
  &quot;imports&quot; : [ &quot;{endpoint}/schemas/bbp/core/entity/v1.0.0/&quot;],
  &quot;shapes&quot; : [ {
    &quot;@id&quot; : &quot;this:Circuit&quot;,
    &quot;@type&quot; : &quot;sh:NodeShape&quot;,
    &quot;targetClass&quot; : &quot;bbp:Circuit&quot;,
    &quot;nodeKind&quot;: &quot;sh:IRI&quot;,
     &quot;and&quot;:[{
        &quot;node&quot;:&quot;{endpoint}/schemas/bbp/core/entity/v1.0.0/shapes/EntityShape&quot;
      },
      {
       &quot;property&quot; : [
          {
           &quot;path&quot; : &quot;schema:description&quot;,
           &quot;minCount&quot; : 1
           &quot;maxCount&quot; : 1
          },
          {
           &quot;path&quot; : &quot;bbp:morphology&quot;,
           &quot;name&quot; : &quot;morphologies&quot;,
           &quot;description&quot; : &quot;Collection of morphologies used in the circuit building.&quot;,
           &quot;class&quot;: &quot;bbp:Morphology&quot;,
           &quot;minCount&quot;:&quot;1&quot;,
           &quot;maxCount&quot;:&quot;3&quot;
          }
         ]
      }
    ]
  }
  ]
}
</code></pre>
<p>In the previous section, the circuit schema example already introduces a bit the way a shape can be specialized. Indeed combining shapes using the <strong>and</strong> boolean operator conveys a sense of extension. But the specialization can go further than just adding more constraints on top of a reused schema. The <strong>this:Circuit</strong> can further constraint the use of the schema:description property in all bbp:Circuit instances by setting a minimal and a mawimal cardinality. All bbp:Circuit instances must have exactly one value for the property schema:description whereas it&rsquo;s not mandatory for other bbp:Entity instances.</p>
<aside class="notice">
Note that only the and boolean operator can be used for shape specialization.
</aside>
<h4><a href="#frequent-shacl-validation-errors" name="frequent-shacl-validation-errors" class="anchor"><span class="anchor-link"></span></a>Frequent SHACL validation errors</h4>
<p>WIP</p>
</div>
<div>
<a href="https://github.com/BlueBrain/nexus/tree/master/src/main/paradox/docs/tutorial/shacl-in-a-nutshell/constraints.md" title="Edit this page" class="md-source-file md-edit">
Edit this page
</a>
</div>
<div class="print-only">
<span class="md-source-file md-version">
0.1.0*
</span>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
<div class="md-footer-copyright__highlight">
Nexus is Open Source and available under the Apache 2 License.<br/>
© 2017-2018 <a href="https://epfl.ch/">EPFL</a> | <a href="https://bluebrain.epfl.ch/">The Blue Brain Project</a>

</div>
Powered by
<a href="https://github.com/lightbend/paradox">Paradox</a>
and
<a href="https://jonas.github.io/paradox-material-theme/">Paradox Material Theme</a>

</div>
<div class="md-footer-social">
<a href="https://github.com/BlueBrain" class="md-footer-social__link fa fa-github"></a><a href="https://gitter.im/BlueBrain/nexus" class="md-footer-social__link fa fa-globe"></a>
</div>

</div>
</div>
</footer>

</div>
<script src="../../../assets/javascripts/application.583bbe55.js"></script>
<script src="../../../assets/javascripts/paradox-material-theme.js"></script>
<script>app.initialize({version:"0.17",url:{base:"../../../."}})</script>
<script type="text/javascript" src="../../../lib/prettify/prettify.js"></script>
<script type="text/javascript" src="../../../lib/prettify/lang-scala.js"></script>
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function(event) {
window.prettyPrint && prettyPrint();
});
</script>
</body>
</html>
