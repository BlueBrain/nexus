# v1.9 Release Notes

TODO add link to full changes on github

If you are currently using Nexus Delta from 1.8.x, please
visit the @ref:[migration instructions](v1.8-to-v1.9-migration.md) for the necessary steps to successfully upgrade.

## Nexus Delta

### Resources

#### self, incoming and outgoing links

Those three links are returned in the response of operations related to the different resources.
Until 1.9, they were curied/shortened according to the base and the API mappings defined in the project configuration.

This caused consistency problems as whenever the base or the API mapping were changing, those shortened links were
not valid anymore:

* All data in views displaying metadata (which include those links) had to be indexed again ;
* The change had also to be propagated to other external systems ;
* The resources including download links to files had to be patched

Therefore since 1.9, `_self`, `_incoming` and `outgoing` links are not shortened anymore allowing them to remain stable in
time even if the project configuration changes.

#### Multi fetch

Multiple resources can now be retrieved within a single call with the multi-fetch operation.

@ref:[More information](../delta/api/multi-fetch.md)

#### Payload validation

It is now forbidden for JSON payloads to contain fields beginning with underscore (_). This can be disabled be setting `app.resources.decoding-option` to `lenient`, however it is not recommended as specification of this data in payloads can have unexpected consequences in both data and the user-interface

Listings by types can now be controlled with the `typeOperator` query parameter. Possible values are `or` and `and`, which will match any and all types, respectively.

#### Aggregations

It is now possible to aggregate resources by `@type` or `project`.

@ref:[More information](../delta/api/resources-api.md#aggregations)

#### Remote contexts

When creating/updating a resource, Nexus Delta now keeps track of the remote contexts that have been resolved during the operation.

@ref:[More information](../delta/api/resources-api.md#fetch-remote-contexts)

### Views

#### Indexing errors listing

Indexing errors can now be listed and filtered for a given view.

@ref:[More information](../delta/api/views/index.md#listing-indexing-failures)

#### Resource type filtering performance improvement 

To improve indexing performance, the types defined in the 
@ref:[FilterByType pipe](../delta/api/views/pipes.md#filter-by-type), 
@ref:[Sparql View payload](../delta/api/views/sparql-view-api.md#payload), or the 
@ref:[Composite View source payload](../delta/api/views/composite-view-api.md#sources) 
are filtered in PostgreSQL rather than in Nexus Delta.
This avoids querying for data just to discard it straight away.

#### Compressing requests to Elasticsearch

The different requests to Elasticsearch are now compressed by default allowing to reduce the I/Os especially during indexing.

### Composite views

To enhance performance of indexing of composite views, Nexus Delta introduces the following features.

#### Batching queries to the intermediate space

Construct queries to the intermediate space can now be batched.

@ref:[More information](../delta/api/views/composite-view-api.md#batching-queries-to-the-intermediate-space)

#### Partial reindexing

When a composite view is updated, a diff is performed and only the necessary spaces are reindexed.

For example, if a source is added/updated/removed, all the spaces (intermediate space and projection spaces) get reindexed.
However if a projection is added/updated/removed, now only the space related to this projection is reindexed which reduces the
number of operations and consequently speed up the indexing.

Preserving the intermediate space also reduces the fragmentation of the Blazegraph journal.

@ref:[More information](../delta/api/views/composite-view-api.md#batching-queries-to-the-intermediate-space)

### Elasticsearch Views

The Elasticsearch mapping of an Elasticsearch View can be retrieved.

@ref:[More information](../delta/api/views/elasticsearch-view-api.md#fetch-elasticsearch-mapping)

### Archives

#### Add files by their `_self`
Files can be added to an archive using a `_self`.

@ref:[More information](../delta/api/archives-api.md#payload)

#### Annotated source as a format
Annotated source is now available as an output format when creating an archive.

@ref:[More information](../delta/api/archives-api.md#payload)

### Storages

Storages can no longer be created with credentials that would get stored:

* For S3 storages, this would be `accessKey`/`secretKey`. 
* For remote storages, this means `credentials`. 

These should instead be defined in the Delta configuration.

@ref:[More information](../getting-started/running-nexus/configuration/index.md#remote-storage-configuration)

### Graph Analytics

The Elasticsearch views behind Graph Analytics can now be queried using the `_search` endpoint.

@ref:[More information](../delta/api/graph-analytics-api.md)

## Nexus Fusion

TODO

## Nexus forge

TODO
