<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="description" content="nexus">
<meta name="generator" content="Paradox, paradox-material-theme=0.5.1, mkdocs-material=3.0.3">

<meta name="lang:clipboard.copy" content="Copy to clipboard">
<meta name="lang:clipboard.copied" content="Copied to clipboard">
<meta name="lang:search.language" content="">
<meta name="lang:search.pipeline.stopwords" content="true">
<meta name="lang:search.pipeline.trimmer" content="true">
<meta name="lang:search.result.none" content="No matching documents">
<meta name="lang:search.result.one" content="1 matching document">
<meta name="lang:search.result.other" content="# matching documents">
<meta name="lang:search.tokenizer" content="[\s\-]+">


<meta name="description" content="nexus">
<link rel="shortcut icon" href="../../.././assets/img/favicon-32x32.png">
<title>Migration from v1.0 to v1.1 · Blue Brain Nexus</title>
<link rel="stylesheet" href="../../../assets/stylesheets/application.451f80e5.css">
<link rel="stylesheet" href="../../../assets/stylesheets/application-palette.22915126.css">
<meta name="theme-color" content="#03a9f4" />
<link rel="stylesheet" href="../../../lib/material__tabs/dist/mdc.tabs.min.css">
<link rel="stylesheet" href="../../../lib/prettify/prettify.css">
<script src="../../../assets/javascripts/modernizr.1aa3b519.js"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
<style>
body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}
code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}
</style>
<link rel="stylesheet" href="../../../assets/fonts/font-awesome.css">
<link rel="stylesheet" href="../../../assets/fonts/material-icons.css">
<link rel="stylesheet" href="../../../assets/stylesheets/paradox-material-theme.css">
<link rel="stylesheet" href="../../.././assets/css/docs.css">
</head>
<body
data-md-color-primary="light-blue"
data-md-color-accent="cyan"
>
<input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
<input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
<label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
<header class="md-header" data-md-component="header">
<nav class="md-header-nav md-grid">
<div class="md-flex">
<div class="md-flex__cell md-flex__cell--shrink">
<a href="../../../docs/index.html" title="Blue Brain Nexus" class="md-header-nav__button md-logo">
<img src="../../.././assets/img/logo.png" width="24" height="24">
</a>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
</div>
<div class="md-flex__cell md-flex__cell--stretch">
<div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
<span class="md-header-nav__topic">
Blue Brain Nexus
</span>
<span class="md-header-nav__topic">
Migration from v1.0 to v1.1
</span>
</div>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
<label class="md-icon md-search__icon" for="__search"></label>
<button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">&#xE5CD;</button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix>
<div class="md-search-result" data-md-component="result">
<div class="md-search-result__meta">
Type to start searching
</div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>

</div>
<div class="md-flex__cell md-flex__cell--shrink">
<div class="md-header-nav__source">
<a href="https://github.com/BlueBrain/nexus"
title="Go to repository"
class="md-source"
data-md-source="github">
<div class="md-source__icon">
<i class="fa fa-github"></i>
</div>
<div class="md-source__repository">
BlueBrain/nexus
</div>
</a>

</div>
</div>
</div>
</nav>
</header>

<div class="md-container">
<main class="md-main">
<div class="md-main__inner md-grid" data-md-component="container">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--primary" data-md-level="0" style="visibility: hidden">
<label class="md-nav__title md-nav__title--site" for="drawer">
<a href="../../../docs/index.html" title="Blue Brain Nexus" class="md-nav__button md-logo">
<span class="md-nav__button md-logo">
<img src="../../.././assets/img/logo.png" width="24" height="24">
</a>
<a href="../../../docs/index.html" title="Blue Brain Nexus">
Blue Brain Nexus
</a>
</label>
<div class="md-nav__source">
<a href="https://github.com/BlueBrain/nexus"
title="Go to repository"
class="md-source"
data-md-source="github">
<div class="md-source__icon">
<i class="fa fa-github"></i>
</div>
<div class="md-source__repository">
BlueBrain/nexus
</div>
</a>

</div>
<ul>
  <li><a href="../../../docs/getting-started/index.html" class="page">Getting Started</a>
  <ul>
    <li><a href="../../../docs/getting-started/nexus-concepts.html" class="page">Brief introduction of Nexus concepts</a></li>
    <li><a href="../../../docs/getting-started/running-nexus/index.html" class="page">Running Nexus</a></li>
    <li><a href="../../../docs/getting-started/webapps.html" class="page">Web applications</a></li>
  </ul></li>
  <li><a href="../../../docs/tutorial/index.html" class="page">Tutorials</a>
  <ul>
    <li><a href="../../../docs/tutorial/getting-started/index.html" class="page">Quick Start Guide</a>
    <ul>
      <li><a href="../../../docs/tutorial/getting-started/setup/index.html" class="page">Set up</a></li>
      <li><a href="../../../docs/tutorial/getting-started/quick-start/index.html" class="page">Quick Start</a></li>
      <li><a href="../../../docs/tutorial/getting-started/dataset/index.html" class="page">The MovieLens Dataset</a></li>
    </ul></li>
    <li><a href="../../../docs/tutorial/knowledge-graph/index.html" class="page">Understanding knowledge graphs</a>
    <ul>
      <li><a href="../../../docs/tutorial/knowledge-graph/thinking-in-graph.html" class="page">Thinking in graph</a></li>
      <li><a href="../../../docs/tutorial/knowledge-graph/understanding-jsonld.html" class="page">Understanding JSON-LD</a></li>
      <li><a href="../../../docs/tutorial/knowledge-graph/querying-knowledge-graph-sparql.html" class="page">Querying knowledge graph using SPARQL</a></li>
      <li><a href="../../../docs/tutorial/knowledge-graph/querying-knowledge-graph-elasticsearch.html" class="page">Querying knowledge graph using Elasticsearch</a></li>
    </ul></li>
    <li><a href="../../../docs/tutorial/linking-data/index.html" class="page">Linking data on the web</a></li>
    <li><a href="../../../docs/tutorial/build-recommender/index.html" class="page">Building a Data Pipeline for a Recommender System</a></li>
  </ul></li>
  <li><a href="../../../docs/api/index.html" class="page">API reference</a>
  <ul>
    <li><a href="../../../docs/api/1.0/index.html" class="page">1.0</a>
    <ul>
      <li><a href="../../../docs/api/1.0/anatomy.html" class="page">Services anatomy</a></li>
      <li><a href="../../../docs/api/1.0/operating-on-resources.html" class="page">Operating on resources</a></li>
      <li><a href="../../../docs/api/1.0/admin/index.html" class="page">Admin API</a>
      <ul>
        <li><a href="../../../docs/api/1.0/admin/admin-orgs-api.html" class="page">Organizations</a></li>
        <li><a href="../../../docs/api/1.0/admin/admin-projects-api.html" class="page">Projects</a></li>
      </ul></li>
      <li><a href="../../../docs/api/1.0/kg/index.html" class="page">Knowledge Graph API</a>
      <ul>
        <li><a href="../../../docs/api/1.0/kg/kg-schemas-api.html" class="page">Schemas</a></li>
        <li><a href="../../../docs/api/1.0/kg/kg-resolvers-api.html" class="page">Resolvers</a></li>
        <li><a href="../../../docs/api/1.0/kg/kg-views-api.html" class="page">Views</a></li>
        <li><a href="../../../docs/api/1.0/kg/kg-files-api.html" class="page">Files</a></li>
        <li><a href="../../../docs/api/1.0/kg/kg-resources-api.html" class="page">Resources</a></li>
      </ul></li>
      <li><a href="../../../docs/api/1.0/iam/index.html" class="page">Identity &amp; Access Management API</a>
      <ul>
        <li><a href="../../../docs/api/1.0/iam/iam-realms-api.html" class="page">Realms</a></li>
        <li><a href="../../../docs/api/1.0/iam/authentication.html" class="page">Authentication</a></li>
        <li><a href="../../../docs/api/1.0/iam/iam-permissions-api.html" class="page">Permissions</a></li>
        <li><a href="../../../docs/api/1.0/iam/iam-acls-api.html" class="page">Access Control Lists</a></li>
        <li><a href="../../../docs/api/1.0/iam/iam-identities.html" class="page">Identities</a></li>
      </ul></li>
      <li><a href="../../../docs/api/1.0/error-signaling.html" class="page">Error Signaling</a></li>
    </ul></li>
    <li><a href="../../../docs/api/1.1/index.html" class="page">1.1 (stable)</a>
    <ul>
      <li><a href="../../../docs/api/1.1/anatomy.html" class="page">Services anatomy</a></li>
      <li><a href="../../../docs/api/1.1/operating-on-resources.html" class="page">Operating on resources</a></li>
      <li><a href="../../../docs/api/1.1/admin/index.html" class="page">Admin API</a>
      <ul>
        <li><a href="../../../docs/api/1.1/admin/admin-orgs-api.html" class="page">Organizations</a></li>
        <li><a href="../../../docs/api/1.1/admin/admin-projects-api.html" class="page">Projects</a></li>
      </ul></li>
      <li><a href="../../../docs/api/1.1/kg/index.html" class="page">Knowledge Graph API</a>
      <ul>
        <li><a href="../../../docs/api/1.1/kg/kg-schemas-api.html" class="page">Schemas</a></li>
        <li><a href="../../../docs/api/1.1/kg/kg-resolvers-api.html" class="page">Resolvers</a></li>
        <li><a href="../../../docs/api/1.1/kg/kg-views-api.html" class="page">Views</a></li>
        <li><a href="../../../docs/api/1.1/kg/kg-storages-api.html" class="page">Storages</a></li>
        <li><a href="../../../docs/api/1.1/kg/kg-files-api.html" class="page">Files</a></li>
        <li><a href="../../../docs/api/1.1/kg/kg-resources-api.html" class="page">Resources</a></li>
      </ul></li>
      <li><a href="../../../docs/api/1.1/iam/index.html" class="page">Identity &amp; Access Management API</a>
      <ul>
        <li><a href="../../../docs/api/1.1/iam/iam-realms-api.html" class="page">Realms</a></li>
        <li><a href="../../../docs/api/1.1/iam/authentication.html" class="page">Authentication</a></li>
        <li><a href="../../../docs/api/1.1/iam/iam-permissions-api.html" class="page">Permissions</a></li>
        <li><a href="../../../docs/api/1.1/iam/iam-acls-api.html" class="page">Access Control Lists</a></li>
        <li><a href="../../../docs/api/1.1/iam/iam-identities.html" class="page">Identities</a></li>
      </ul></li>
      <li><a href="../../../docs/api/1.1/error-signaling.html" class="page">Error Signaling</a></li>
    </ul></li>
  </ul></li>
  <li><a href="../../../docs/releases/index.html" class="page">Releases</a>
  <ul>
    <li><a href="../../../docs/releases/1.0/index.html" class="page">1.0</a></li>
    <li><a href="../../../docs/releases/1.1/index.html" class="page">1.1 (stable)</a>
    <ul>
      <li><a href="../../../docs/releases/1.1/release.html" class="page">Release Notes</a></li>
      <li><a href="../../../docs/releases/1.1/changelog.html" class="page">Changelog</a></li>
      <li><a href="../../../docs/releases/1.1/migration.html" class="active page">Migration from v1.0 to v1.1</a></li>
    </ul></li>
  </ul></li>
  <li><a href="../../../docs/faq.html" class="page">Frequently asked questions</a></li>
  <li><a href="../../../docs/additional-info/index.html" class="page">Additional Information</a>
  <ul>
    <li><a href="../../../docs/additional-info/sdk.html" class="page">SDKs for Nexus</a></li>
    <li><a href="../../../docs/additional-info/architecture/index.html" class="page">System Architecture</a>
    <ul>
      <li><a href="../../../docs/additional-info/architecture/use-cases.html" class="page">Use Cases</a></li>
      <li><a href="../../../docs/additional-info/architecture/components.html" class="page">Components</a></li>
      <li><a href="../../../docs/additional-info/architecture/integration.html" class="page">Integration</a></li>
    </ul></li>
    <li><a href="../../../docs/additional-info/benchmarks/index.html" class="page">Benchmarks</a>
    <ul>
      <li><a href="../../../docs/additional-info/benchmarks/deployment-configuration.html" class="page">Deployment Configuration</a></li>
      <li><a href="../../../docs/additional-info/benchmarks/data-volume-and-scenarios.html" class="page">Data volume and scenarios</a></li>
      <li><a href="../../../docs/additional-info/benchmarks/results.html" class="page">Results</a></li>
    </ul></li>
    <li><a href="../../../docs/additional-info/web-applications-standards.html" class="page">Web applications development best practices</a></li>
  </ul></li>
</ul>
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul>
  <li><a href="../../../docs/releases/1.1/migration.html#migration-from-v1-0-to-v1-1" class="header">Migration from v1.0 to v1.1</a>
  <ul>
    <li><a href="../../../docs/releases/1.1/migration.html#migration-process" class="header">Migration process</a>
    <ul>
      <li><a href="../../../docs/releases/1.1/migration.html#iam-and-admin-migration-process" class="header">Iam and admin migration process</a></li>
      <li><a href="../../../docs/releases/1.1/migration.html#kg-migration-process" class="header">Kg migration process</a></li>
    </ul></li>
  </ul></li>
</ul>
</nav>

</nav>
<ul style="display: none">
<li class="md-nav__item md-version" id="project.version">
<label class="md-nav__link" for="__version">
<i class="md-icon" title="Version">label_outline</i> 0.1.0*
</label>
</li>
</ul>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul>
  <li><a href="../../../docs/releases/1.1/migration.html#migration-from-v1-0-to-v1-1" class="header">Migration from v1.0 to v1.1</a>
  <ul>
    <li><a href="../../../docs/releases/1.1/migration.html#migration-process" class="header">Migration process</a>
    <ul>
      <li><a href="../../../docs/releases/1.1/migration.html#iam-and-admin-migration-process" class="header">Iam and admin migration process</a></li>
      <li><a href="../../../docs/releases/1.1/migration.html#kg-migration-process" class="header">Kg migration process</a></li>
    </ul></li>
  </ul></li>
</ul>
</nav>

</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<div class="md-content__searchable">
<h1><a href="#migration-from-v1-0-to-v1-1" name="migration-from-v1-0-to-v1-1" class="anchor"><span class="anchor-link"></span></a>Migration from v1.0 to v1.1</h1>
<p>In order to migrate your service from v1.0 to v1.1 you will need to do the following:</p>
<ul>
  <li>Stop the 3 services: iam, admin and kg.</li>
  <li><a href="https://docs.datastax.com/en/archived/cassandra/3.0/cassandra/operations/opsBackupRestore.html">Backup</a> your cassandra store. This step is a safeguard against anything which could go wrong during migration scripts.</li>
  <li>Wipe the current Elasticsearch data.</li>
  <li>Wipe the current Blazegraph data.</li>
  <li>Update Elasticsearch software from 6.x to 7.2 or above.</li>
  <li>Use the new <a href="https://hub.docker.com/r/bluebrain/nexus-iam">iam</a>, <a href="https://hub.docker.com/r/bluebrain/nexus-admin">admin</a> and <a href="https://hub.docker.com/r/bluebrain/nexus-kg">kg</a> docker images, tagged at the version <code>1.1.0</code>. We recommend you following the <a href="../../getting-started/running-nexus/index.html">running nexus</a> documentation in order to run nexus, since it packages all the services you need to run nexus (cassandra, elasticsearch, blazegraph).</li>
  <li>When running iam and admin services for the first time in v1.1, set the environment variable <code>REPAIR_FROM_MESSAGES</code> to <code>true</code>. This environment variable should be removed in subsequent runs.</li>
  <li>When running kg service for the first time in v1.1, set the environment variable <code>MIGRATE_V10_TO_V11</code> to <code>true</code>. This environment variable should be removed in subsequent runs.</li>
</ul>
<h2><a href="#migration-process" name="migration-process" class="anchor"><span class="anchor-link"></span></a>Migration process</h2>
<p>This section explains what happens during the migration process. Although the knowledge of what is happening behind the scenes should not be necessary to successfully migrate to v1.1, it might be of interest.</p>
<h3><a href="#iam-and-admin-migration-process" name="iam-and-admin-migration-process" class="anchor"><span class="anchor-link"></span></a>Iam and admin migration process</h3>
<p>The migration for those services is straight forward since the changes introduced did not affect the main models in the cassandra store. </p>
<p>In this case we needed to make sure that every row which should be present in the <code>tag_views</code> cassandra table, is indeed there. To achieve that, we run the service and retrieve all the resources from the <code>messages</code> table. </p>
<h3><a href="#kg-migration-process" name="kg-migration-process" class="anchor"><span class="anchor-link"></span></a>Kg migration process</h3>
<p>The migration for this service includes several steps, since the content on the cassandra store <code>messages</code> table is going to be modified. This is required because we have introduced some changes on the representation of the main models.</p>
<p>The following steps are executed:</p>
<ul>
  <li>the <code>messages</code> table suffers modifications for the file, storages and default views related events.</li>
  <li>the <code>projections</code> related tables are dropped in order to wipe the indices progress. Once the progress is wiped, indexing in Elasticsearch and Blazegraph will start from the beginning.</li>
  <li>the <code>tab_views</code> related tables are truncated, since it&rsquo;s content is not up to date anymore.</li>
  <li>all the resources on the <code>messages</code> table are retrieved one by one in order to populate the <code>tag_views</code> related tables.</li>
</ul>
</div>
<div>
<a href="https://github.com/BlueBrain/nexus/tree/master/src/main/paradox/docs/releases/1.1/migration.md" title="Edit this page" class="md-source-file md-edit">
Edit this page
</a>
</div>
<div class="print-only">
<span class="md-source-file md-version">
0.1.0*
</span>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav class="md-footer-nav__inner md-grid">
<a href="../../../docs/releases/1.1/changelog.html" title="Changelog" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
</div>
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
Previous
</span>
Changelog
</span>
</div>
</a>
<a href="../../../docs/faq.html" title="Frequently asked questions" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
Next
</span>
Frequently asked questions
</span>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
<div class="md-footer-copyright__highlight">
Nexus is Open Source and available under the Apache 2 License.<br/>
© 2017-2019 <a href="https://epfl.ch/">EPFL</a> | <a href="https://bluebrain.epfl.ch/">The Blue Brain Project</a>

</div>
Powered by
<a href="https://github.com/lightbend/paradox">Paradox</a>
and
<a href="https://jonas.github.io/paradox-material-theme/">Paradox Material Theme</a>

</div>
<div class="md-footer-social">
<a href="https://github.com/BlueBrain" class="md-footer-social__link fa fa-github"></a><a href="https://gitter.im/BlueBrain/nexus" class="md-footer-social__link fa fa-globe"></a>
</div>

</div>
</div>
</footer>

</div>
<script src="../../../assets/javascripts/application.583bbe55.js"></script>
<script src="../../../assets/javascripts/paradox-material-theme.js"></script>
<script>app.initialize({version:"0.17",url:{base:"../../../."}})</script>
<script type="text/javascript" src="../../../lib/prettify/prettify.js"></script>
<script type="text/javascript" src="../../../lib/prettify/lang-scala.js"></script>
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function(event) {
window.prettyPrint && prettyPrint();
});
</script>
</body>
</html>
