{"version":3,"sources":["../../src/utils/get-latest-apis.ts"],"names":["API_FILE","ROOT","path","join","__dirname","OUTPUT_FILE","getLatestAPIs","data","axios","get","timeout","fs","writeFile","JSON","stringify","e","pathExists","readJSON","catch","browser","node","ssr"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AAEA,MAAMA,QAAQ,GAAI,oCAAlB;;AACA,MAAMC,IAAI,GAAGC,cAAKC,IAAL,CAAUC,SAAV,EAAsB,IAAtB,EAA4B,IAA5B,CAAb;;AACA,MAAMC,WAAW,GAAGH,cAAKC,IAAL,CAAUF,IAAV,EAAiB,kBAAjB,CAApB;;AAQO,MAAMK,aAAa,GAAG,YAAmC;AAC9D,MAAI;AACF,UAAM;AAAEC,MAAAA;AAAF,QAAW,MAAMC,eAAMC,GAAN,CAAUT,QAAV,EAAoB;AAAEU,MAAAA,OAAO,EAAE;AAAX,KAApB,CAAvB;AAEA,UAAMC,iBAAGC,SAAH,CAAaP,WAAb,EAA0BQ,IAAI,CAACC,SAAL,CAAeP,IAAf,EAAqB,IAArB,EAA2B,CAA3B,CAA1B,EAA0D,MAA1D,CAAN;AAEA,WAAOA,IAAP;AACD,GAND,CAME,OAAOQ,CAAP,EAAU;AACV,QAAI,MAAMJ,iBAAGK,UAAH,CAAcX,WAAd,CAAV,EAAsC;AACpC,aAAOM,iBAAGM,QAAH,CAAYZ,WAAZ,CAAP;AACD,KAHS,CAIV;;;AACA,WAAOM,iBAAGM,QAAH,CAAYf,cAAKC,IAAL,CAAUF,IAAV,EAAiB,WAAjB,CAAZ,EAA0CiB,KAA1C,CAAgD,MAAM;AAC3D,aAAO;AACLC,QAAAA,OAAO,EAAE,EADJ;AAELC,QAAAA,IAAI,EAAE,EAFD;AAGLC,QAAAA,GAAG,EAAE;AAHA,OAAP;AAKD,KANM,CAAP;AAOD;AACF,CApBM","sourcesContent":["import path from \"path\"\nimport fs from \"fs-extra\"\nimport axios from \"axios\"\n\nconst API_FILE = `https://unpkg.com/gatsby/apis.json`\nconst ROOT = path.join(__dirname, `..`, `..`)\nconst OUTPUT_FILE = path.join(ROOT, `latest-apis.json`)\n\nexport interface IAPIResponse {\n  browser: Record<string, any>\n  node: Record<string, any>\n  ssr: Record<string, any>\n}\n\nexport const getLatestAPIs = async (): Promise<IAPIResponse> => {\n  try {\n    const { data } = await axios.get(API_FILE, { timeout: 5000 })\n\n    await fs.writeFile(OUTPUT_FILE, JSON.stringify(data, null, 2), `utf8`)\n\n    return data\n  } catch (e) {\n    if (await fs.pathExists(OUTPUT_FILE)) {\n      return fs.readJSON(OUTPUT_FILE)\n    }\n    // possible offline/network issue\n    return fs.readJSON(path.join(ROOT, `apis.json`)).catch(() => {\n      return {\n        browser: {},\n        node: {},\n        ssr: {},\n      }\n    })\n  }\n}\n"],"file":"get-latest-apis.js"}