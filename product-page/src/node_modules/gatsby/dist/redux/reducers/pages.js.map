{"version":3,"sources":["../../../src/redux/reducers/pages.ts"],"names":["pagesReducer","state","Map","action","type","payload","component","plugin","name","console","log","error","JSON","stringify","Error","pluginCreator___NODE","id","pluginCreatorId","set","path","delete"],"mappings":";;;;;;;AAAA;;AASO,MAAMA,YAAY,GAAG,CAC1BC,KAA4B,GAAG,IAAIC,GAAJ,EADL,EAE1BC,MAF0B,KAGA;AAC1B,UAAQA,MAAM,CAACC,IAAf;AACE,SAAM,cAAN;AACE,aAAO,IAAIF,GAAJ,EAAP;;AAEF,SAAM,aAAN;AAAoB;AAAA;;AAClBC,QAAAA,MAAM,CAACE,OAAP,CAAeC,SAAf,GAA2B,4BAAUH,MAAM,CAACE,OAAP,CAAeC,SAAzB,CAA3B,CADkB,CAGlB;;AACA,YAAI,oBAACH,MAAM,CAACI,MAAR,mDAAC,eAAeC,IAAhB,CAAJ,EAA0B;AACxBC,UAAAA,OAAO,CAACC,GAAR,CAAa,EAAb;AACAD,UAAAA,OAAO,CAACE,KAAR,CAAcC,IAAI,CAACC,SAAL,CAAeV,MAAf,EAAuB,IAAvB,EAA6B,CAA7B,CAAd;AACAM,UAAAA,OAAO,CAACC,GAAR,CAAa,EAAb;AAEA,gBAAM,IAAII,KAAJ,CACH,0FADG,CAAN;AAGD,SAZiB,CAclB;;;AACAX,QAAAA,MAAM,CAACE,OAAP,CAAeU,oBAAf,wBAAsCZ,MAAM,CAACI,MAAP,CAAcS,EAApD,iEAA2D,EAA3D;AACAb,QAAAA,MAAM,CAACE,OAAP,CAAeY,eAAf,yBAAiCd,MAAM,CAACI,MAAP,CAAcS,EAA/C,mEAAsD,EAAtD,CAhBkB,CAkBlB;;AACAf,QAAAA,KAAK,CAACiB,GAAN,CAAUf,MAAM,CAACE,OAAP,CAAec,IAAzB,EAA+BhB,MAAM,CAACE,OAAtC;AAEA,eAAOJ,KAAP;AACD;;AAED,SAAM,aAAN;AAAoB;AAClBA,QAAAA,KAAK,CAACmB,MAAN,CAAajB,MAAM,CAACE,OAAP,CAAec,IAA5B;AAEA,eAAOlB,KAAP;AACD;;AAED;AACE,aAAOA,KAAP;AAnCJ;AAqCD,CAzCM","sourcesContent":["import normalize from \"normalize-path\"\nimport {\n  IGatsbyState,\n  IGatsbyPage,\n  IDeleteCacheAction,\n  ICreatePageAction,\n  IDeletePageAction,\n} from \"../types\"\n\nexport const pagesReducer = (\n  state: IGatsbyState[\"pages\"] = new Map<string, IGatsbyPage>(),\n  action: IDeleteCacheAction | ICreatePageAction | IDeletePageAction\n): IGatsbyState[\"pages\"] => {\n  switch (action.type) {\n    case `DELETE_CACHE`:\n      return new Map()\n\n    case `CREATE_PAGE`: {\n      action.payload.component = normalize(action.payload.component)\n\n      // throws an error if the page is not created by a plugin\n      if (!action.plugin?.name) {\n        console.log(``)\n        console.error(JSON.stringify(action, null, 4))\n        console.log(``)\n\n        throw new Error(\n          `Pages can only be created by plugins. There wasn't a plugin set when creating this page.`\n        )\n      }\n\n      // Link page to its plugin.\n      action.payload.pluginCreator___NODE = action.plugin.id ?? ``\n      action.payload.pluginCreatorId = action.plugin.id ?? ``\n\n      // Add page to the state with the path as key\n      state.set(action.payload.path, action.payload)\n\n      return state\n    }\n\n    case `DELETE_PAGE`: {\n      state.delete(action.payload.path)\n\n      return state\n    }\n\n    default:\n      return state\n  }\n}\n"],"file":"pages.js"}