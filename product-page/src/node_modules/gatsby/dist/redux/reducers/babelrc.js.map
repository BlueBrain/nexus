{"version":3,"sources":["../../../src/redux/reducers/babelrc.ts"],"names":["babelrcReducer","state","stages","develop","plugins","presets","options","cacheDirectory","sourceType","action","type","Object","keys","forEach","stage","payload","index","_","findIndex","plugin","name","merge"],"mappings":"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","sourcesContent":["import _ from \"lodash\"\n\nimport { IGatsbyState, ActionsUnion, IPlugin } from \"../types\"\n\nexport const babelrcReducer = (\n  state: IGatsbyState[\"babelrc\"] = {\n    stages: {\n      develop: {\n        plugins: [],\n        presets: [],\n        options: {\n          cacheDirectory: true,\n          sourceType: `unambiguous`,\n        },\n      },\n      \"develop-html\": {\n        plugins: [],\n        presets: [],\n        options: {\n          cacheDirectory: true,\n          sourceType: `unambiguous`,\n        },\n      },\n      \"build-html\": {\n        plugins: [],\n        presets: [],\n        options: {\n          cacheDirectory: true,\n          sourceType: `unambiguous`,\n        },\n      },\n      \"build-javascript\": {\n        plugins: [],\n        presets: [],\n        options: {\n          cacheDirectory: true,\n          sourceType: `unambiguous`,\n        },\n      },\n    },\n  },\n  action: ActionsUnion\n): IGatsbyState[\"babelrc\"] => {\n  switch (action.type) {\n    case `SET_BABEL_PLUGIN`: {\n      Object.keys(state.stages).forEach(stage => {\n        if (action.payload.stage && action.payload.stage !== stage) {\n          return\n        }\n\n        const index = _.findIndex(\n          state.stages[stage].plugins,\n          (plugin: IPlugin) => plugin.name === action.payload.name\n        )\n        // If the plugin already exists, merge the options.\n        // Otherwise, add it to the end.\n        if (index !== -1) {\n          const plugin = state.stages[stage].plugins[index]\n          state.stages[stage].plugins[index] = {\n            name: plugin.name,\n            options: _.merge(plugin.options, action.payload.options),\n          }\n        } else {\n          state.stages[stage].plugins = [\n            ...state.stages[stage].plugins,\n            action.payload,\n          ]\n        }\n      })\n\n      return state\n    }\n    case `SET_BABEL_PRESET`: {\n      Object.keys(state.stages).forEach(stage => {\n        if (action.payload.stage && action.payload.stage !== stage) {\n          return\n        }\n\n        const index = _.findIndex(\n          state.stages[stage].presets,\n          (plugin: IPlugin) => plugin.name === action.payload.name\n        )\n        // If the plugin already exists, merge the options.\n        // Otherwise, add it to the end.\n        if (index !== -1) {\n          const plugin = state.stages[stage].presets[index]\n          state.stages[stage].presets[index] = {\n            name: plugin.name,\n            options: _.merge(plugin.options, action.payload.options),\n          }\n        } else {\n          state.stages[stage].presets = [\n            ...state.stages[stage].presets,\n            action.payload,\n          ]\n        }\n      })\n      return state\n    }\n    case `SET_BABEL_OPTIONS`: {\n      Object.keys(state.stages).forEach(stage => {\n        if (action.payload.stage && action.payload.stage !== stage) {\n          return\n        }\n\n        state.stages[stage].options = {\n          ...state.stages[stage].options,\n          ...action.payload.options,\n        }\n      })\n      return state\n    }\n  }\n\n  return state\n}\n"],"file":"babelrc.js"}