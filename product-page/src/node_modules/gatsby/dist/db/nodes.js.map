{"version":3,"sources":["../../src/db/nodes.ts"],"names":["loadNodeContent","node","internal","content","plugin","store","getState","flattenedPlugins","find","plug","name","owner","Error","require","resolve"],"mappings":";;;;;AACA;;AAEA;;;AAGO,eAAeA,eAAf,CAA+BC,IAA/B,EAAmE;AACxE,MAAI,OAAOA,IAAI,CAACC,QAAL,CAAcC,OAArB,KAAkC,QAAtC,EAA+C;AAC7C,WAAOF,IAAI,CAACC,QAAL,CAAcC,OAArB;AACD,GAHuE,CAKxE;;;AACA,QAAMC,MAAM,GAAGC,aACZC,QADY,GAEZC,gBAFY,CAEKC,IAFL,CAEUC,IAAI,IAAIA,IAAI,CAACC,IAAL,KAAcT,IAAI,CAACC,QAAL,CAAcS,KAF9C,CAAf;;AAIA,MAAI,CAACP,MAAL,EAAa;AACX,UAAM,IAAIQ,KAAJ,CACH,wEAAuEX,IAAI,CAACC,QAAL,CAAcS,KAAM,IADxF,CAAN;AAGD;;AAED,QAAM;AAAEX,IAAAA;AAAF,MAAsBa,OAAO,CAACT,MAAM,CAACU,OAAR,CAAnC;;AAEA,MAAI,CAACd,eAAL,EAAsB;AACpB,UAAM,IAAIY,KAAJ,CACH,sDAAqDR,MAAM,CAACM,IAAK,EAD9D,CAAN;AAGD;;AAED,QAAMP,OAAO,GAAG,MAAMH,eAAe,CAACC,IAAD,CAArC;AAEAA,EAAAA,IAAI,CAACC,QAAL,CAAcC,OAAd,GAAwBA,OAAxB;AAEA,SAAOA,OAAP;AACD","sourcesContent":["import { IGatsbyNode } from \"../redux/types\"\nimport { store } from \"../redux\"\n\n/**\n * Get content for a node from the plugin that created it.\n */\nexport async function loadNodeContent(node: IGatsbyNode): Promise<string> {\n  if (typeof node.internal.content === `string`) {\n    return node.internal.content\n  }\n\n  // Load plugin's loader function\n  const plugin = store\n    .getState()\n    .flattenedPlugins.find(plug => plug.name === node.internal.owner)\n\n  if (!plugin) {\n    throw new Error(\n      `Could not find owner plugin of node for loadNodeContent with owner \\`${node.internal.owner}\\``\n    )\n  }\n\n  const { loadNodeContent } = require(plugin.resolve)\n\n  if (!loadNodeContent) {\n    throw new Error(\n      `Could not find function loadNodeContent for plugin ${plugin.name}`\n    )\n  }\n\n  const content = await loadNodeContent(node)\n\n  node.internal.content = content\n\n  return content\n}\n"],"file":"nodes.js"}