"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,n=require("react"),t=(e=n)&&"object"==typeof e&&"default"in e?e.default:e,r=require("@reach/utils");function o(){return(o=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(this,arguments)}exports.DescendantProvider=function(e){var r=e.context,i=e.children,a=e.items,u=e.set,c=n.useCallback((function(e){var n=e.element,t=e.index,r=function(e,n){if(null==e)return{};var t,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n.indexOf(t=i[r])>=0||(o[t]=e[t]);return o}(e,["element","index"]);n&&u((function(e){var i;if(null!=t)i=[].concat(e,[o({},r,{element:n,index:t})]);else if(0===e.length)i=[].concat(e,[o({},r,{element:n,index:0})]);else if(e.find((function(e){return e.element===n})))i=e;else{var a=e.findIndex((function(e){return!(!e.element||!n)&&Boolean(e.element.compareDocumentPosition(n)&Node.DOCUMENT_POSITION_PRECEDING)})),u=o({},r,{element:n,index:a});i=-1===a?[].concat(e,[u]):[].concat(e.slice(0,a),[u],e.slice(a))}return i.map((function(e,n){return o({},e,{index:n})}))}))}),[]),s=n.useCallback((function(e){e&&u((function(n){return n.filter((function(n){return e!==n.element}))}))}),[]);return t.createElement(r.Provider,{value:n.useMemo((function(){return{descendants:a,registerDescendant:c,unregisterDescendant:s}}),[a,c,s])},i)},exports.createDescendantContext=function(e,n){return void 0===n&&(n={}),r.createNamedContext(e,o({descendants:[],registerDescendant:r.noop,unregisterDescendant:r.noop},n))},exports.useDescendant=function(e,t,i){var a=n.useState()[1],u=n.useContext(t),c=u.registerDescendant,s=u.unregisterDescendant,l=u.descendants,f=null!=i?i:l.findIndex((function(n){return n.element===e.element})),d=r.usePrevious(l),v=l.some((function(e,n){var t;return e.element!==(null==d||null===(t=d[n])||void 0===t?void 0:t.element)}));return r.useIsomorphicLayoutEffect((function(){return e.element||a({}),c(o({},e,{index:f})),function(){return s(e.element)}}),[c,s,f,v].concat(Object.values(e))),f},exports.useDescendantKeyDown=function(e,t){var r=n.useContext(e).descendants,o=t.callback,i=t.currentIndex,a=t.filter,u=t.key,c=void 0===u?"index":u,s=t.orientation,l=void 0===s?"vertical":s,f=t.rotate,d=void 0===f||f,v=t.rtl,p=void 0!==v&&v,D=null!=i?i:-1;return function(e){if(["ArrowDown","ArrowUp","ArrowLeft","ArrowRight","PageUp","PageDown","Home","End"].includes(e.key)){var n=a?r.filter(a):r;if(a&&(D=n.findIndex((function(e){return e.index===i}))),n.length)switch(e.key){case"ArrowDown":if("vertical"===l||"both"===l){e.preventDefault();var t=g();o("option"===c?t:t[c])}break;case"ArrowUp":if("vertical"===l||"both"===l){e.preventDefault();var u=b();o("option"===c?u:u[c])}break;case"ArrowLeft":if("horizontal"===l||"both"===l){e.preventDefault();var s=(p?g:b)();o("option"===c?s:s[c])}break;case"ArrowRight":if("horizontal"===l||"both"===l){e.preventDefault();var f=(p?b:g)();o("option"===c?f:f[c])}break;case"PageUp":e.preventDefault();var v=(e.ctrlKey?b:w)();o("option"===c?v:v[c]);break;case"Home":e.preventDefault();var x=w();o("option"===c?x:x[c]);break;case"PageDown":e.preventDefault();var m=(e.ctrlKey?g:k)();o("option"===c?m:m[c]);break;case"End":e.preventDefault();var h=k();o("option"===c?h:h[c])}}function g(){return D===n.length-1?d?w():n[D]:n[(D+1)%n.length]}function b(){return 0===D?d?k():n[D]:n[(D-1+n.length)%n.length]}function w(){return n[0]}function k(){return n[n.length-1]}}},exports.useDescendants=function(e){return n.useContext(e).descendants},exports.useDescendantsInit=function(){return n.useState([])};
//# sourceMappingURL=descendants.cjs.production.min.js.map
